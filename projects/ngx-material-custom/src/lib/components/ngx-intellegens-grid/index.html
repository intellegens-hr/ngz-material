<table mat-table
  class="mat-elevation-z8"
  [dataSource] ="data | ngxIntellegensGridFilterBy:filters
                      | ngxIntellegensGridOrderBy:orderingField:orderingAscDirection
                      | ngxIntellegensGridPaginate:pageLength:pageIndex" 
  matSort matSortDisableClear="true" (matSortChange)="onMatTableSort($event)">

  <!-- Header definition (and layout) -->
  <ng-container *matHeaderRowDef="dataKeys">
    <!-- Default headers -->
    <tr mat-header-row></tr>
    <!-- Filtering row -->
    <tr *ngIf="config.filtering.hasFiltering && config.filtering.hasFilterColumns">
      <th *ngFor="let key of dataKeys">
          <input (keyup)="onFilterUpdated(key, $event)" [disabled]="config.columnDefinition[key] && config.columnDefinition[key].hasFiltering === false" type="text">
      </th>
    </tr>
  </ng-container>

  <!-- Table columns layout -->
  <ng-container *ngFor="let key of dataKeys" [matColumnDef]="key">
    <!-- Column header -->
    <th mat-header-cell *matHeaderCellDef
      mat-sort-header [disabled]="config.columnDefinition[key] && !config.columnDefinition[key].sortable">
      {{ config.columnDefinition[key] && config.columnDefinition[key].header ? config.columnDefinition[key].header : key }} 
    </th>
    <!-- Column body cell -->
    <td mat-cell *matCellDef="let element">
      {{ element[key] }}
    </td>
    <!-- Column footer -->
    <td mat-footer-cell *matFooterCellDef>
      {{ config.columnDefinition[key] && config.columnDefinition[key].footer ? config.columnDefinition[key].footer : key  }}
    </td>
  </ng-container>

  <!-- Body row(s) definition (and layout) -->
  <ng-container *matRowDef="let row; columns: dataKeys;">
    <!-- Default body row cells -->
    <tr mat-row></tr>
  </ng-container>

  <!-- Footer definition (and layout) -->
  <ng-container *matFooterRowDef="dataKeys">
    <!-- Default footers -->
    <tr mat-footer-row></tr>
  </ng-container>

</table>

<!-- Pagination -->
<mat-paginator *ngIf="config.pagination.hasPagination !== false"
  class="mat-elevation-z8"
  [length]="totalLength" [pageSize]="config.pagination.defaultPageLength"  [pageSizeOptions]="config.pagination.pageLengthOptions"
  (page)="onMatTablePage($event)"></mat-paginator>

<!-- Error overlay -->
<div class="container" *ngIf="error || internalError">
  <div class="content">Error</div>
</div>

<!-- Loading overlay -->
<div class="container" *ngIf="((!error && !internalError) && (loading || internalLoading))">
  <div class="content">Loading</div>
</div>
